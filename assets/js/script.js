// ===== LANGUAGE TRANSLATIONS =====
const translations = {
    vi: {
        // Navigation
        home: "Trang chủ",
        about: "Giới thiệu", 
        skills: "Kỹ năng",
        projects: "Dự án",
        contact: "Liên hệ",
        
        // Banner
        greeting: "Xin chào, tôi là",
        name: "Sinh viên IT",
        subtitle: "Sinh viên năm 2 chuyên ngành Công nghệ Thông tin<br>Đam mê phát triển web và lập trình",
        role: "Web Developer",
        learnMore: "Tìm hiểu thêm",
        contactMe: "Liên hệ",
        
        // About
        aboutTitle: "Thông tin cá nhân",
        careerGoal: "Mục tiêu nghề nghiệp",
        careerDesc: "Là sinh viên năm 2 chuyên ngành Công nghệ Thông tin, tôi đam mê phát triển web và luôn tìm tòi học hỏi những công nghệ mới. Mục tiêu của tôi là trở thành một lập trình viên web full-stack chuyên nghiệp, có khả năng xây dựng những ứng dụng web hiện đại và thân thiện với người dùng.",
        interests: "Sở thích",
        fullName: "Họ và tên",
        birthDate: "Ngày sinh",
        phone: "Số điện thoại",
        email: "Email",
        address: "Địa chỉ",
        
        // Skills
        skillsTitle: "Kỹ năng & Ngôn ngữ",
        programmingSkills: "Kỹ năng lập trình",
        languages: "Ngôn ngữ",
        vietnamese: "Tiếng Việt",
        english: "Tiếng Anh",
        chinese: "Tiếng Trung",
        native: "Bản ngữ",
        intermediate: "Trung cấp",
        beginner: "Cơ bản",
        
        // Achievements
        achievementsTitle: "Chứng chỉ - Giải thưởng",
        achievement1: "Giải Ba Cuộc thi Lập trình",
        achievement1Desc: "Cuộc thi lập trình sinh viên cấp trường năm 2023",
        achievement2: "Chứng chỉ HTML/CSS",
        achievement2Desc: "Hoàn thành khóa học HTML/CSS cơ bản và nâng cao",
        achievement3: "Học bổng Khuyến khích học tập",
        achievement3Desc: "Đạt học bổng khuyến khích học tập học kỳ 1 năm 2023",
        
        // Projects
        projectsTitle: "Dự án",
        project1: "Website Bán hàng",
        project1Desc: "Trang web bán hàng trực tuyến sử dụng HTML, CSS, JavaScript",
        project2: "Ứng dụng Todo List",
        project2Desc: "Ứng dụng quản lý công việc với React và Local Storage",
        project3: "Game Đoán số",
        project3Desc: "Game đơn giản được xây dựng bằng Python",
        
        // Contact
        contactTitle: "Liên hệ",
        contactInfo: "Thông tin liên hệ",
        sendMessage: "Gửi tin nhắn",
        namePlaceholder: "Họ và tên",
        emailPlaceholder: "Email",
        subjectPlaceholder: "Chủ đề",
        messagePlaceholder: "Tin nhắn",
        sendBtn: "Gửi tin nhắn",
        
        // Footer
        footerText: "Được thiết kế bởi Sinh viên IT",
        
        // Notifications
        fillAllFields: "Vui lòng điền đầy đủ thông tin!",
        invalidEmail: "Email không hợp lệ!",
        sending: "Đang gửi tin nhắn...",
        success: "Tin nhắn đã được gửi thành công!"
    },
    en: {
        // Navigation
        home: "Home",
        about: "About",
        skills: "Skills", 
        projects: "Projects",
        contact: "Contact",
        
        // Banner
        greeting: "Hello, I am",
        name: "IT Student",
        subtitle: "2nd year Information Technology student<br>Passionate about web development and programming",
        role: "Web Developer",
        learnMore: "Learn More",
        contactMe: "Contact",
        
        // About
        aboutTitle: "Personal Information",
        careerGoal: "Career Objective",
        careerDesc: "As a 2nd year Information Technology student, I am passionate about web development and always eager to learn new technologies. My goal is to become a professional full-stack web developer, capable of building modern and user-friendly web applications.",
        interests: "Interests",
        fullName: "Full Name",
        birthDate: "Birth Date",
        phone: "Phone",
        email: "Email",
        address: "Address",
        
        // Skills
        skillsTitle: "Skills & Languages",
        programmingSkills: "Programming Skills",
        languages: "Languages",
        vietnamese: "Vietnamese",
        english: "English",
        chinese: "Chinese",
        native: "Native",
        intermediate: "Intermediate",
        beginner: "Beginner",
        
        // Achievements
        achievementsTitle: "Certificates - Awards",
        achievement1: "3rd Place Programming Contest",
        achievement1Desc: "University-level programming contest 2023",
        achievement2: "HTML/CSS Certificate",
        achievement2Desc: "Completed basic and advanced HTML/CSS course",
        achievement3: "Academic Excellence Scholarship",
        achievement3Desc: "Received academic excellence scholarship semester 1, 2023",
        
        // Projects
        projectsTitle: "Projects",
        project1: "E-commerce Website",
        project1Desc: "Online shopping website using HTML, CSS, JavaScript",
        project2: "Todo List Application",
        project2Desc: "Task management application with React and Local Storage",
        project3: "Number Guessing Game",
        project3Desc: "Simple game built with Python",
        
        // Contact
        contactTitle: "Contact",
        contactInfo: "Contact Information",
        sendMessage: "Send Message",
        namePlaceholder: "Full Name",
        emailPlaceholder: "Email",
        subjectPlaceholder: "Subject",
        messagePlaceholder: "Message",
        sendBtn: "Send Message",
        
        // Footer
        footerText: "Designed by IT Student",
        
        // Notifications
        fillAllFields: "Please fill in all fields!",
        invalidEmail: "Invalid email!",
        sending: "Sending message...",
        success: "Message sent successfully!"
    },
    zh: {
        // Navigation
        home: "首页",
        about: "关于我",
        skills: "技能",
        projects: "项目",
        contact: "联系",
        
        // Banner
        greeting: "你好，我是",
        name: "IT学生",
        subtitle: "信息技术专业二年级学生<br>热爱网页开发和编程",
        role: "网页开发者",
        learnMore: "了解更多",
        contactMe: "联系我",
        
        // About
        aboutTitle: "个人信息",
        careerGoal: "职业目标",
        careerDesc: "作为信息技术专业的二年级学生，我热爱网页开发，总是渴望学习新技术。我的目标是成为一名专业的全栈网页开发者，能够构建现代化和用户友好的网页应用程序。",
        interests: "兴趣爱好",
        fullName: "姓名",
        birthDate: "出生日期",
        phone: "电话",
        email: "邮箱",
        address: "地址",
        
        // Skills
        skillsTitle: "技能与语言",
        programmingSkills: "编程技能",
        languages: "语言",
        vietnamese: "越南语",
        english: "英语",
        chinese: "中文",
        native: "母语",
        intermediate: "中级",
        beginner: "初级",
        
        // Achievements
        achievementsTitle: "证书 - 奖项",
        achievement1: "编程竞赛三等奖",
        achievement1Desc: "2023年大学级编程竞赛",
        achievement2: "HTML/CSS证书",
        achievement2Desc: "完成HTML/CSS基础和高级课程",
        achievement3: "学业优秀奖学金",
        achievement3Desc: "获得2023年第一学期学业优秀奖学金",
        
        // Projects
        projectsTitle: "项目",
        project1: "电商网站",
        project1Desc: "使用HTML、CSS、JavaScript的在线购物网站",
        project2: "待办事项应用",
        project2Desc: "使用React和本地存储的任务管理应用",
        project3: "猜数字游戏",
        project3Desc: "使用Python构建的简单游戏",
        
        // Contact
        contactTitle: "联系方式",
        contactInfo: "联系信息",
        sendMessage: "发送消息",
        namePlaceholder: "姓名",
        emailPlaceholder: "邮箱",
        subjectPlaceholder: "主题",
        messagePlaceholder: "消息",
        sendBtn: "发送消息",
        
        // Footer
        footerText: "由IT学生设计",
        
        // Notifications
        fillAllFields: "请填写所有字段！",
        invalidEmail: "邮箱无效！",
        sending: "正在发送消息...",
        success: "消息发送成功！"
    }
};

// ===== CURRENT LANGUAGE =====
let currentLanguage = 'vi';

// ===== DOCUMENT READY =====
document.addEventListener('DOMContentLoaded', function() {
    // Initialize all functions
    initNavigation();
    initScrollAnimations();
    initSkillBars();
    initTypingEffect();
    initContactForm();
    initBackToTop();
    initSmoothScrolling();
    initParallaxEffect();
    initParticles();
    initLanguageSwitcher();
    initMobileOptimizations();
    initAdvancedAnimations();
    initThemeEffects();
});

// ===== LANGUAGE SWITCHER =====
function initLanguageSwitcher() {
    // Create language switcher if it doesn't exist
    if (!document.querySelector('.language-switcher')) {
        const languageSwitcher = document.createElement('div');
        languageSwitcher.className = 'language-switcher';
        languageSwitcher.innerHTML = `
            <div class="language-dropdown">
                <button class="language-btn" id="languageBtn">
                    <i class="fas fa-globe"></i>
                    <span class="current-lang">VI</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="language-options" id="languageOptions">
                    <div class="language-option" data-lang="vi">
                        <img src="https://flagcdn.com/w20/vn.png" alt="Vietnamese">
                        <span>Tiếng Việt</span>
                    </div>
                    <div class="language-option" data-lang="en">
                        <img src="https://flagcdn.com/w20/us.png" alt="English">
                        <span>English</span>
                    </div>
                    <div class="language-option" data-lang="zh">
                        <img src="https://flagcdn.com/w20/cn.png" alt="Chinese">
                        <span>中文</span>
                    </div>
                </div>
            </div>
        `;
        
        // Add to navbar
        const navContainer = document.querySelector('.nav-container');
        navContainer.appendChild(languageSwitcher);
    }

    const languageBtn = document.getElementById('languageBtn');
    const languageOptions = document.getElementById('languageOptions');
    const languageOptionElements = document.querySelectorAll('.language-option');

    // Toggle dropdown
    languageBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        languageOptions.classList.toggle('show');
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', function() {
        languageOptions.classList.remove('show');
    });

    // Language selection
    languageOptionElements.forEach(option => {
        option.addEventListener('click', function() {
            const selectedLang = this.getAttribute('data-lang');
            changeLanguage(selectedLang);
            languageOptions.classList.remove('show');
        });
    });
}

function changeLanguage(lang) {
    currentLanguage = lang;
    const currentLangSpan = document.querySelector('.current-lang');
    
    // Update current language display
    switch(lang) {
        case 'vi':
            currentLangSpan.textContent = 'VI';
            break;
        case 'en':
            currentLangSpan.textContent = 'EN';
            break;
        case 'zh':
            currentLangSpan.textContent = 'ZH';
            break;
    }

    // Update all text content
    updatePageContent(lang);
    
    // Save language preference
    localStorage.setItem('preferredLanguage', lang);
    
    // Show notification
    showNotification(getTranslation('languageChanged', lang), 'success');
}

function updatePageContent(lang) {
    const t = translations[lang];
    
    // Navigation
    document.querySelector('a[href="#home"]').textContent = t.home;
    document.querySelector('a[href="#about"]').textContent = t.about;
    document.querySelector('a[href="#skills"]').textContent = t.skills;
    document.querySelector('a[href="#projects"]').textContent = t.projects;
    document.querySelector('a[href="#contact"]').textContent = t.contact;
    
    // Banner
    document.querySelector('.typing-text').textContent = t.greeting;
    document.querySelector('.name-highlight').textContent = t.name;
    document.querySelector('.banner-subtitle').innerHTML = t.subtitle;
    document.querySelector('.profile-info p').textContent = t.role;
    document.querySelector('.btn-primary').textContent = t.learnMore;
    document.querySelector('.btn-secondary').textContent = t.contactMe;
    
    // About section
    document.querySelector('#about .section-title').textContent = t.aboutTitle;
    document.querySelector('.about-description h3').textContent = t.careerGoal;
    document.querySelector('.about-description p').textContent = t.careerDesc;
    document.querySelector('.interests h4').textContent = t.interests;
    
    // Info items
    const infoItems = document.querySelectorAll('.info-item .info-text h4');
    infoItems[0].textContent = t.fullName;
    infoItems[1].textContent = t.birthDate;
    infoItems[2].textContent = t.phone;
    infoItems[3].textContent = t.email;
    infoItems[4].textContent = t.address;
    
    // Skills section
    document.querySelector('#skills .section-title').textContent = t.skillsTitle;
    document.querySelector('.skills-category:first-child h3').textContent = t.programmingSkills;
    document.querySelector('.skills-category:last-child h3').textContent = t.languages;
    
    // Language items
    const languageItems = document.querySelectorAll('.language-name');
    if (languageItems.length >= 2) {
        languageItems[0].textContent = t.vietnamese;
        languageItems[1].textContent = t.english;
    }
    
    const languageLevels = document.querySelectorAll('.language-level');
    if (languageLevels.length >= 2) {
        languageLevels[0].textContent = t.native;
        languageLevels[1].textContent = t.intermediate;
    }
    
    // Achievements
    document.querySelector('#achievements .section-title').textContent = t.achievementsTitle;
    const achievementTitles = document.querySelectorAll('.achievement-content h4');
    const achievementDescs = document.querySelectorAll('.achievement-content p');
    
    if (achievementTitles.length >= 3) {
        achievementTitles[0].textContent = t.achievement1;
        achievementTitles[1].textContent = t.achievement2;
        achievementTitles[2].textContent = t.achievement3;
    }
    
    if (achievementDescs.length >= 3) {
        achievementDescs[0].textContent = t.achievement1Desc;
        achievementDescs[1].textContent = t.achievement2Desc;
        achievementDescs[2].textContent = t.achievement3Desc;
    }
    
    // Projects
    document.querySelector('#projects .section-title').textContent = t.projectsTitle;
    const projectTitles = document.querySelectorAll('.project-content h4');
    const projectDescs = document.querySelectorAll('.project-content p');
    
    if (projectTitles.length >= 3) {
        projectTitles[0].textContent = t.project1;
        projectTitles[1].textContent = t.project2;
        projectTitles[2].textContent = t.project3;
    }
    
    if (projectDescs.length >= 3) {
        projectDescs[0].textContent = t.project1Desc;
        projectDescs[1].textContent = t.project2Desc;
        projectDescs[2].textContent = t.project3Desc;
    }
    
    // Contact
    document.querySelector('#contact .section-title').textContent = t.contactTitle;
    document.querySelector('.contact-info h3').textContent = t.contactInfo;
    document.querySelector('.contact-form h3').textContent = t.sendMessage;
    
    // Form placeholders
    document.querySelector('input[name="name"]').placeholder = t.namePlaceholder;
    document.querySelector('input[name="email"]').placeholder = t.emailPlaceholder;
    document.querySelector('input[name="subject"]').placeholder = t.subjectPlaceholder;
    document.querySelector('textarea[name="message"]').placeholder = t.messagePlaceholder;
    document.querySelector('button[type="submit"]').textContent = t.sendBtn;
    
    // Footer
    document.querySelector('.footer-content p').innerHTML = `&copy; 2024 CV Portfolio. ${t.footerText}.`;
}

function getTranslation(key, lang = currentLanguage) {
    return translations[lang] && translations[lang][key] ? translations[lang][key] : translations['vi'][key];
}

// ===== MOBILE OPTIMIZATIONS =====
function initMobileOptimizations() {
    // Touch gestures
    let touchStartX = 0;
    let touchStartY = 0;
    
    document.addEventListener('touchstart', function(e) {
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
    });
    
    document.addEventListener('touchend', function(e) {
        const touchEndX = e.changedTouches[0].clientX;
        const touchEndY = e.changedTouches[0].clientY;
        
        const deltaX = touchEndX - touchStartX;
        const deltaY = touchEndY - touchStartY;
        
        // Swipe detection
        if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
            if (deltaX > 0) {
                // Swipe right
                handleSwipeRight();
            } else {
                // Swipe left
                handleSwipeLeft();
            }
        }
    });
    
    // Mobile menu improvements
    const navToggle = document.getElementById('nav-toggle');
    const navMenu = document.getElementById('nav-menu');
    
    if (navToggle && navMenu) {
        // Add touch feedback
        navToggle.addEventListener('touchstart', function() {
            this.style.transform = 'scale(0.95)';
        });
        
        navToggle.addEventListener('touchend', function() {
            this.style.transform = 'scale(1)';
        });
    }
    
    // Improve touch targets
    const touchTargets = document.querySelectorAll('.btn, .nav-link, .social-link, .project-link');
    touchTargets.forEach(target => {
        target.style.minHeight = '44px';
        target.style.minWidth = '44px';
    });
    
    // Prevent zoom on input focus (iOS)
    const inputs = document.querySelectorAll('input, textarea');
    inputs.forEach(input => {
        input.addEventListener('focus', function() {
            if (window.innerWidth < 768) {
                document.querySelector('meta[name="viewport"]').setAttribute('content', 
                    'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
            }
        });
        
        input.addEventListener('blur', function() {
            if (window.innerWidth < 768) {
                document.querySelector('meta[name="viewport"]').setAttribute('content', 
                    'width=device-width, initial-scale=1.0');
            }
        });
    });
}

function handleSwipeRight() {
    // Navigate to previous section or show mobile menu
    const navMenu = document.getElementById('nav-menu');
    if (navMenu && !navMenu.classList.contains('active')) {
        navMenu.classList.add('active');
        document.getElementById('nav-toggle').classList.add('active');
    }
}

function handleSwipeLeft() {
    // Hide mobile menu or navigate to next section
    const navMenu = document.getElementById('nav-menu');
    if (navMenu && navMenu.classList.contains('active')) {
        navMenu.classList.remove('active');
        document.getElementById('nav-toggle').classList.remove('active');
    }
}

// ===== ADVANCED ANIMATIONS =====
function initAdvancedAnimations() {
    // Magnetic effect for buttons
    const magneticElements = document.querySelectorAll('.btn, .social-link, .project-link');
    
    magneticElements.forEach(element => {
        element.addEventListener('mousemove', function(e) {
            const rect = this.getBoundingClientRect();
            const x = e.clientX - rect.left - rect.width / 2;
            const y = e.clientY - rect.top - rect.height / 2;
            
            this.style.transform = `translate(${x * 0.1}px, ${y * 0.1}px)`;
        });
        
        element.addEventListener('mouseleave', function() {
            this.style.transform = 'translate(0, 0)';
        });
    });
    
    // Text reveal animation
    const textElements = document.querySelectorAll('h1, h2, h3, p');
    const textObserver = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('text-reveal');
            }
        });
    }, { threshold: 0.1 });
    
    textElements.forEach(element => {
        textObserver.observe(element);
    });
    
    // Stagger animation for cards
    const cardGroups = [
        document.querySelectorAll('.achievement-card'),
        document.querySelectorAll('.project-card'),
        document.querySelectorAll('.skill-item')
    ];
    
    cardGroups.forEach(cards => {
        cards.forEach((card, index) => {
            card.style.animationDelay = `${index * 0.1}s`;
        });
    });
}

// ===== THEME EFFECTS =====
function initThemeEffects() {
    // Cursor trail effect
    const cursor = document.createElement('div');
    cursor.className = 'cursor-trail';
    document.body.appendChild(cursor);
    
    let mouseX = 0;
    let mouseY = 0;
    let cursorX = 0;
    let cursorY = 0;
    
    document.addEventListener('mousemove', function(e) {
        mouseX = e.clientX;
        mouseY = e.clientY;
    });
    
    function animateCursor() {
        cursorX += (mouseX - cursorX) * 0.1;
        cursorY += (mouseY - cursorY) * 0.1;
        
        cursor.style.left = cursorX + 'px';
        cursor.style.top = cursorY + 'px';
        
        requestAnimationFrame(animateCursor);
    }
    animateCursor();
    
    // Dynamic background based on scroll
    window.addEventListener('scroll', function() {
        const scrollPercent = window.scrollY / (document.documentElement.scrollHeight - window.innerHeight);
        const hue = scrollPercent * 360;
        
        document.body.style.setProperty('--dynamic-hue', hue);
    });
    
    // Time-based greeting
    updateTimeBasedGreeting();
    setInterval(updateTimeBasedGreeting, 60000); // Update every minute
}

function updateTimeBasedGreeting() {
    const hour = new Date().getHours();
    const greetingElement = document.querySelector('.typing-text');
    
    if (!greetingElement) return;
    
    let greeting;
    if (hour < 12) {
        greeting = currentLanguage === 'vi' ? 'Chào buổi sáng, tôi là' : 
                  currentLanguage === 'en' ? 'Good morning, I am' : '早上好，我是';
    } else if (hour < 18) {
        greeting = currentLanguage === 'vi' ? 'Chào buổi chiều, tôi là' : 
                  currentLanguage === 'en' ? 'Good afternoon, I am' : '下午好，我是';
    } else {
        greeting = currentLanguage === 'vi' ? 'Chào buổi tối, tôi là' : 
                  currentLanguage === 'en' ? 'Good evening, I am' : '晚上好，我是';
    }
    
    greetingElement.textContent = greeting;
}

// ===== PARTICLE SYSTEM =====
function initParticles() {
    const particlesContainer = document.createElement('div');
    particlesContainer.className = 'particles';
    document.body.appendChild(particlesContainer);
    
    function createParticle() {
        const particle = document.createElement('div');
        particle.className = 'particle';
        
        // Random position
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDuration = (Math.random() * 3 + 2) + 's';
        particle.style.animationDelay = Math.random() * 2 + 's';
        
        particlesContainer.appendChild(particle);
        
        // Remove particle after animation
        setTimeout(() => {
            if (particle.parentNode) {
                particle.parentNode.removeChild(particle);
            }
        }, 6000);
    }
    
    // Create particles periodically
    setInterval(createParticle, 500);
}

// ===== NAVIGATION FUNCTIONALITY =====
function initNavigation() {
    const navbar = document.getElementById('navbar');
    const navToggle = document.getElementById('nav-toggle');
    const navMenu = document.getElementById('nav-menu');
    const navLinks = document.querySelectorAll('.nav-link');

    // Navbar scroll effect
    window.addEventListener('scroll', function() {
        if (window.scrollY > 50) {
            navbar.classList.add('scrolled');
        } else {
            navbar.classList.remove('scrolled');
        }
    });

    // Mobile menu toggle
    if (navToggle && navMenu) {
        navToggle.addEventListener('click', function() {
            navMenu.classList.toggle('active');
            navToggle.classList.toggle('active');
        });
    }

    // Close mobile menu when clicking on a link
    navLinks.forEach(link => {
        link.addEventListener('click', function() {
            if (navMenu) navMenu.classList.remove('active');
            if (navToggle) navToggle.classList.remove('active');
        });
    });

    // Active navigation link highlighting
    window.addEventListener('scroll', function() {
        let current = '';
        const sections = document.querySelectorAll('section');
        
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;
            if (scrollY >= (sectionTop - 200)) {
                current = section.getAttribute('id');
            }
        });

        navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === '#' + current) {
                link.classList.add('active');
            }
        });
    });
}

// ===== SCROLL ANIMATIONS =====
function initScrollAnimations() {
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
            }
        });
    }, observerOptions);

    // Add animation classes to elements
    const animatedElements = document.querySelectorAll('.info-card, .achievement-card, .project-card, .skills-category');
    animatedElements.forEach((el, index) => {
        el.classList.add('fade-in');
        el.style.transitionDelay = `${index * 0.1}s`;
        observer.observe(el);
    });

    // Add slide animations
    const leftElements = document.querySelectorAll('.about-info');
    leftElements.forEach(el => {
        el.classList.add('slide-in-left');
        observer.observe(el);
    });

    const rightElements = document.querySelectorAll('.about-description');
    rightElements.forEach(el => {
        el.classList.add('slide-in-right');
        observer.observe(el);
    });
}

// ===== SKILL BARS ANIMATION =====
function initSkillBars() {
    const skillBars = document.querySelectorAll('.skill-progress');
    
    const skillObserver = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const skillBar = entry.target;
                const width = skillBar.getAttribute('data-width');
                
                setTimeout(() => {
                    skillBar.style.width = width + '%';
                }, 500);
                
                skillObserver.unobserve(skillBar);
            }
        });
    }, { threshold: 0.5 });

    skillBars.forEach(bar => {
        skillObserver.observe(bar);
    });
}

// ===== TYPING EFFECT =====
function initTypingEffect() {
    const typingText = document.querySelector('.typing-text');
    if (!typingText) return;

    const texts = {
        vi: ['Xin chào, tôi là', 'Chào bạn, tôi là', 'Chào mừng bạn!'],
        en: ['Hello, I am', 'Hi there, I am', 'Welcome!'],
        zh: ['你好，我是', '您好，我是', '欢迎！']
    };
    
    let textIndex = 0;
    let charIndex = 0;
    let isDeleting = false;
    let typingSpeed = 100;

    function typeText() {
        const currentTexts = texts[currentLanguage] || texts.vi;
        const currentText = currentTexts[textIndex];
        
        if (isDeleting) {
            typingText.textContent = currentText.substring(0, charIndex - 1);
            charIndex--;
            typingSpeed = 50;
        } else {
            typingText.textContent = currentText.substring(0, charIndex + 1);
            charIndex++;
            typingSpeed = 100;
        }

        if (!isDeleting && charIndex === currentText.length) {
            setTimeout(() => {
                isDeleting = true;
            }, 2000);
        } else if (isDeleting && charIndex === 0) {
            isDeleting = false;
            textIndex = (textIndex + 1) % currentTexts.length;
        }

        setTimeout(typeText, typingSpeed);
    }

    // Start typing effect after a delay
    setTimeout(typeText, 1000);
}

// ===== CONTACT FORM =====
function initContactForm() {
    const contactForm = document.getElementById('contactForm');
    if (!contactForm) return;

    contactForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Get form data
        const formData = new FormData(contactForm);
        const name = formData.get('name');
        const email = formData.get('email');
        const subject = formData.get('subject');
        const message = formData.get('message');

        // Simple validation
        if (!name || !email || !subject || !message) {
            showNotification(getTranslation('fillAllFields'), 'error');
            return;
        }

        if (!isValidEmail(email)) {
            showNotification(getTranslation('invalidEmail'), 'error');
            return;
        }

        // Simulate form submission
        showNotification(getTranslation('sending'), 'info');
        
        setTimeout(() => {
            showNotification(getTranslation('success'), 'success');
            contactForm.reset();
        }, 2000);
    });
}

// ===== UTILITY FUNCTIONS =====
function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}

function showNotification(message, type) {
    // Remove existing notifications
    const existingNotification = document.querySelector('.notification');
    if (existingNotification) {
        existingNotification.remove();
    }

    // Create notification element
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.textContent = message;
    
    // Add styles
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 25px;
        border-radius: 10px;
        color: white;
        font-weight: 500;
        z-index: 10000;
        transform: translateX(100%);
        transition: transform 0.3s ease;
        max-width: 300px;
        word-wrap: break-word;
        backdrop-filter: blur(10px);
    `;

    // Set background color based on type
    switch(type) {
        case 'success':
            notification.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
            break;
        case 'error':
            notification.style.background = 'linear-gradient(135deg, #f44336, #da190b)';
            break;
        case 'info':
            notification.style.background = 'linear-gradient(135deg, #2196F3, #0b7dda)';
            break;
    }

    // Add to document
    document.body.appendChild(notification);

    // Animate in
    setTimeout(() => {
        notification.style.transform = 'translateX(0)';
    }, 100);

    // Auto remove after 4 seconds
    setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    }, 4000);
}

// ===== BACK TO TOP BUTTON =====
function initBackToTop() {
    const backToTopBtn = document.getElementById('backToTop');
    if (!backToTopBtn) return;

    window.addEventListener('scroll', function() {
        if (window.scrollY > 300) {
            backToTopBtn.classList.add('show');
        } else {
            backToTopBtn.classList.remove('show');
        }
    });

    backToTopBtn.addEventListener('click', function() {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    });
}

// ===== SMOOTH SCROLLING =====
function initSmoothScrolling() {
    const scrollLinks = document.querySelectorAll('a[href^="#"]');
    
    scrollLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            const targetId = this.getAttribute('href');
            const targetSection = document.querySelector(targetId);
            
            if (targetSection) {
                const offsetTop = targetSection.offsetTop - 80; // Account for fixed navbar
                
                window.scrollTo({
                    top: offsetTop,
                    behavior: 'smooth'
                });
            }
        });
    });

    // Scroll indicator click
    const scrollIndicator = document.querySelector('.scroll-indicator');
    if (scrollIndicator) {
        scrollIndicator.addEventListener('click', function() {
            const aboutSection = document.getElementById('about');
            if (aboutSection) {
                aboutSection.scrollIntoView({ behavior: 'smooth' });
            }
        });
    }
}

// ===== PARALLAX EFFECT =====
function initParallaxEffect() {
    window.addEventListener('scroll', function() {
        const scrolled = window.pageYOffset;
        const parallaxElements = document.querySelectorAll('.banner::before');
        
        parallaxElements.forEach(element => {
            const speed = 0.5;
            element.style.transform = `translateY(${scrolled * speed}px)`;
        });
    });
}

// ===== INTERACTIVE ELEMENTS =====
document.addEventListener('DOMContentLoaded', function() {
    // Add hover effects to cards
    const cards = document.querySelectorAll('.info-card, .achievement-card, .project-card, .skills-category');
    
    cards.forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-10px) scale(1.02)';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
        });
    });

    // Add click effects to buttons
    const buttons = document.querySelectorAll('.btn');
    
    buttons.forEach(button => {
        button.addEventListener('click', function(e) {
            // Create ripple effect
            const ripple = document.createElement('span');
            const rect = this.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = e.clientX - rect.left - size / 2;
            const y = e.clientY - rect.top - size / 2;
            
            ripple.style.cssText = `
                position: absolute;
                width: ${size}px;
                height: ${size}px;
                left: ${x}px;
                top: ${y}px;
                background: rgba(255, 255, 255, 0.3);
                border-radius: 50%;
                transform: scale(0);
                animation: ripple 0.6s linear;
                pointer-events: none;
            `;
            
            this.style.position = 'relative';
            this.style.overflow = 'hidden';
            this.appendChild(ripple);
            
            setTimeout(() => {
                ripple.remove();
            }, 600);
        });
    });

    // Add CSS for ripple animation
    const style = document.createElement('style');
    style.textContent = `
        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        .cursor-trail {
            position: fixed;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, rgba(255, 107, 107, 0.8), transparent);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            mix-blend-mode: difference;
        }
        
        .text-reveal {
            animation: textReveal 0.8s ease-out;
        }
        
        @keyframes textReveal {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .language-switcher {
            position: relative;
        }
        
        .language-dropdown {
            position: relative;
        }
        
        .language-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #e0e0e0;
            padding: 8px 15px;
            border-radius: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .language-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .language-options {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 10px 0;
            min-width: 150px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
            margin-top: 10px;
        }
        
        .language-options.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .language-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #e0e0e0;
        }
        
        .language-option:hover {
            background: rgba(255, 107, 107, 0.1);
            color: #ff6b6b;
        }
        
        .language-option img {
            width: 20px;
            height: auto;
            border-radius: 2px;
        }
        
        @media (max-width: 768px) {
            .language-switcher {
                order: -1;
                margin-right: auto;
            }
            
            .language-btn {
                padding: 6px 12px;
                font-size: 0.9rem;
            }
            
            .language-options {
                right: auto;
                left: 0;
            }
        }
    `;
    document.head.appendChild(style);
});

// ===== LOADING ANIMATION =====
window.addEventListener('load', function() {
    // Hide loading screen if exists
    const loader = document.querySelector('.loader');
    if (loader) {
        loader.style.opacity = '0';
        setTimeout(() => {
            loader.style.display = 'none';
        }, 500);
    }

    // Animate elements on page load
    const bannerElements = document.querySelectorAll('.banner-text, .banner-image');
    bannerElements.forEach((element, index) => {
        element.style.opacity = '0';
        element.style.transform = 'translateY(30px)';
        
        setTimeout(() => {
            element.style.transition = 'all 0.8s ease';
            element.style.opacity = '1';
            element.style.transform = 'translateY(0)';
        }, index * 200 + 500);
    });
    
    // Load saved language preference
    const savedLanguage = localStorage.getItem('preferredLanguage');
    if (savedLanguage && translations[savedLanguage]) {
        changeLanguage(savedLanguage);
    }
});

// ===== PERFORMANCE OPTIMIZATION =====
// Throttle scroll events for better performance
function throttle(func, limit) {
    let inThrottle;
    return function() {
        const args = arguments;
        const context = this;
        if (!inThrottle) {
            func.apply(context, args);
            inThrottle = true;
            setTimeout(() => inThrottle = false, limit);
        }
    }
}

// Apply throttling to scroll events
const throttledScrollHandler = throttle(function() {
    // Handle scroll events here if needed
}, 16); // ~60fps

window.addEventListener('scroll', throttledScrollHandler);

// ===== ACCESSIBILITY IMPROVEMENTS =====
document.addEventListener('keydown', function(e) {
    // Skip to main content with Tab key
    if (e.key === 'Tab' && !e.shiftKey) {
        const focusableElements = document.querySelectorAll(
            'a[href], button, textarea, input[type="text"], input[type="radio"], input[type="checkbox"], select'
        );
        
        // Add focus indicators
        focusableElements.forEach(element => {
            element.addEventListener('focus', function() {
                this.style.outline = '2px solid #ff6b6b';
                this.style.outlineOffset = '2px';
            });
            
            element.addEventListener('blur', function() {
                this.style.outline = 'none';
            });
        });
    }
});

// ===== EASTER EGG =====
let konamiCode = [];
const konamiSequence = [
    'ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown',
    'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight',
    'KeyB', 'KeyA'
];

document.addEventListener('keydown', function(e) {
    konamiCode.push(e.code);
    
    if (konamiCode.length > konamiSequence.length) {
        konamiCode.shift();
    }
    
    if (konamiCode.join(',') === konamiSequence.join(',')) {
        // Easter egg activated!
        showNotification('🎉 Konami Code activated! You found the easter egg!', 'success');
        
        // Add some fun effects
        document.body.style.animation = 'rainbow 2s infinite';
        
        setTimeout(() => {
            document.body.style.animation = '';
        }, 5000);
        
        konamiCode = [];
    }
});

// Add rainbow animation CSS
const rainbowStyle = document.createElement('style');
rainbowStyle.textContent = `
    @keyframes rainbow {
        0% { filter: hue-rotate(0deg); }
        100% { filter: hue-rotate(360deg); }
    }
`;
document.head.appendChild(rainbowStyle);


// ===== VIDEO BACKGROUND FUNCTIONALITY =====
function initVideoBackground() {
    // Create video background with animated canvas
    const videoContainer = document.createElement('div');
    videoContainer.className = 'video-background';
    
    // Create iframe for canvas animation
    const videoFrame = document.createElement('iframe');
    videoFrame.src = 'assets/videos/background-video.html';
    videoFrame.style.cssText = `
        width: 100%;
        height: 100%;
        border: none;
        opacity: 0.4;
        filter: blur(1px) brightness(0.6);
    `;
    
    videoContainer.appendChild(videoFrame);
    document.body.insertBefore(videoContainer, document.body.firstChild);
    
    // Add video controls
    const videoControls = document.createElement('div');
    videoControls.className = 'video-controls';
    videoControls.innerHTML = `
        <button class="video-control-btn" id="videoPlayPause" title="Play/Pause">
            <i class="fas fa-pause"></i>
        </button>
        <button class="video-control-btn" id="videoOpacity" title="Adjust Opacity">
            <i class="fas fa-eye"></i>
        </button>
        <button class="video-control-btn" id="videoEffects" title="Toggle Effects">
            <i class="fas fa-magic"></i>
        </button>
    `;
    
    document.body.appendChild(videoControls);
    
    let isPlaying = true;
    let currentOpacity = 0.4;
    let effectsEnabled = true;
    
    // Add event listeners for video controls
    document.getElementById('videoPlayPause').addEventListener('click', function() {
        isPlaying = !isPlaying;
        const icon = this.querySelector('i');
        
        if (isPlaying) {
            videoFrame.style.display = 'block';
            icon.className = 'fas fa-pause';
            showNotification('Video background resumed', 'success');
        } else {
            videoFrame.style.display = 'none';
            icon.className = 'fas fa-play';
            showNotification('Video background paused', 'info');
        }
    });
    
    document.getElementById('videoOpacity').addEventListener('click', function() {
        currentOpacity = currentOpacity === 0.4 ? 0.2 : currentOpacity === 0.2 ? 0.6 : 0.4;
        videoFrame.style.opacity = currentOpacity;
        showNotification(`Video opacity: ${Math.round(currentOpacity * 100)}%`, 'info');
    });
    
    document.getElementById('videoEffects').addEventListener('click', function() {
        effectsEnabled = !effectsEnabled;
        const icon = this.querySelector('i');
        
        if (effectsEnabled) {
            videoFrame.style.filter = 'blur(1px) brightness(0.6)';
            icon.className = 'fas fa-magic';
            showNotification('Video effects enabled', 'success');
        } else {
            videoFrame.style.filter = 'brightness(0.6)';
            icon.className = 'fas fa-eye-slash';
            showNotification('Video effects disabled', 'info');
        }
    });
}

function showVideoUpgradeModal() {
    const modal = document.createElement('div');
    modal.className = 'upgrade-modal';
    modal.innerHTML = `
        <div class="upgrade-modal-content">
            <div class="upgrade-modal-header">
                <h3>🎬 Video Background Feature</h3>
                <button class="upgrade-modal-close">&times;</button>
            </div>
            <div class="upgrade-modal-body">
                <div class="upgrade-icon">
                    <i class="fas fa-video"></i>
                </div>
                <h4>Unlock Premium Video Backgrounds</h4>
                <p>Enhance your CV with stunning animated video backgrounds that make your portfolio stand out!</p>
                <ul class="upgrade-features">
                    <li><i class="fas fa-check"></i> High-quality animated backgrounds</li>
                    <li><i class="fas fa-check"></i> Multiple video themes</li>
                    <li><i class="fas fa-check"></i> Customizable opacity and effects</li>
                    <li><i class="fas fa-check"></i> Mobile-optimized playback</li>
                </ul>
                <div class="upgrade-buttons">
                    <button class="btn btn-primary upgrade-btn">Upgrade Now</button>
                    <button class="btn btn-secondary close-modal-btn">Maybe Later</button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Add modal styles
    const modalStyles = document.createElement('style');
    modalStyles.textContent = `
        .upgrade-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease;
        }
        
        .upgrade-modal-content {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 0;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideInUp 0.3s ease;
        }
        
        .upgrade-modal-header {
            padding: 2rem 2rem 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .upgrade-modal-header h3 {
            color: #e0e0e0;
            margin: 0;
            font-size: 1.5rem;
        }
        
        .upgrade-modal-close {
            background: none;
            border: none;
            color: #e0e0e0;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .upgrade-modal-close:hover {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
        }
        
        .upgrade-modal-body {
            padding: 2rem;
            text-align: center;
        }
        
        .upgrade-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2rem;
            color: white;
        }
        
        .upgrade-modal-body h4 {
            color: #e0e0e0;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }
        
        .upgrade-modal-body p {
            color: #b0b0b0;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }
        
        .upgrade-features {
            list-style: none;
            padding: 0;
            margin: 1.5rem 0;
            text-align: left;
        }
        
        .upgrade-features li {
            color: #e0e0e0;
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }
        
        .upgrade-features i {
            color: #4ecdc4;
            font-size: 0.9rem;
        }
        
        .upgrade-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        
        .upgrade-buttons .btn {
            flex: 1;
            min-width: 120px;
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @media (max-width: 480px) {
            .upgrade-modal-content {
                width: 95%;
            }
            
            .upgrade-modal-header,
            .upgrade-modal-body {
                padding: 1.5rem;
            }
            
            .upgrade-buttons {
                flex-direction: column;
            }
        }
    `;
    document.head.appendChild(modalStyles);
    
    // Event listeners
    modal.querySelector('.upgrade-modal-close').addEventListener('click', closeModal);
    modal.querySelector('.close-modal-btn').addEventListener('click', closeModal);
    modal.querySelector('.upgrade-btn').addEventListener('click', function() {
        showNotification('Thank you for your interest! Please contact support for upgrade options.', 'info');
        closeModal();
    });
    
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            closeModal();
        }
    });
    
    function closeModal() {
        modal.style.animation = 'fadeOut 0.3s ease';
        setTimeout(() => {
            if (modal.parentNode) {
                modal.parentNode.removeChild(modal);
                modalStyles.parentNode.removeChild(modalStyles);
            }
        }, 300);
    }
}

// ===== ENHANCED ANIMATIONS =====
function initEnhancedAnimations() {
    // Add floating animation to cards
    const cards = document.querySelectorAll('.info-card, .achievement-card, .project-card, .skills-category');
    cards.forEach((card, index) => {
        card.classList.add('floating');
        card.style.animationDelay = `${index * 0.5}s`;
    });
    
    // Add glow effect to important elements
    const glowElements = document.querySelectorAll('.profile-card, .banner-title');
    glowElements.forEach(element => {
        element.classList.add('glow-effect');
    });
    
    // Add morph shape to some cards
    const morphCards = document.querySelectorAll('.achievement-card:nth-child(odd)');
    morphCards.forEach(card => {
        card.classList.add('morph-shape');
    });
    
    // Add liquid shape to profile image
    const profileImg = document.querySelector('.profile-img');
    if (profileImg) {
        profileImg.classList.add('liquid-shape');
    }
    
    // Enhanced scroll reveal animations
    initEnhancedScrollAnimations();
    
    // Magnetic effect for interactive elements
    initMagneticEffect();
    
    // Enhanced particle system
    initEnhancedParticleSystem();
    
    // Matrix rain effect
    initMatrixRain();
    
    // Subtle text effect for titles instead of neon
    const titles = document.querySelectorAll('.banner-title, .section-title');
    titles.forEach(title => {
        title.classList.add('elegant-text');
    });
    
    // Enhanced button effects
    const buttons = document.querySelectorAll('.btn');
    buttons.forEach(button => {
        button.classList.add('enhanced-btn');
    });
    
    // Breathing animation for profile card
    const profileCard = document.querySelector('.profile-card');
    if (profileCard) {
        profileCard.classList.add('breathing');
    }
    
    // Tilt effect for project cards
    const projectCards = document.querySelectorAll('.project-card');
    projectCards.forEach(card => {
        card.classList.add('tilt-element');
    });
}

function initEnhancedScrollAnimations() {
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('revealed');
            }
        });
    }, observerOptions);
    
    // Add different reveal animations
    const revealElements = document.querySelectorAll('.info-card, .achievement-card');
    revealElements.forEach((el, index) => {
        el.classList.add('scroll-reveal');
        el.style.transitionDelay = `${index * 0.1}s`;
        observer.observe(el);
    });
    
    const leftElements = document.querySelectorAll('.about-info');
    leftElements.forEach(el => {
        el.classList.add('scroll-reveal-left');
        observer.observe(el);
    });
    
    const rightElements = document.querySelectorAll('.about-description');
    rightElements.forEach(el => {
        el.classList.add('scroll-reveal-right');
        observer.observe(el);
    });
}

function initMagneticEffect() {
    const magneticElements = document.querySelectorAll('.btn, .social-link, .project-link, .nav-link');
    
    magneticElements.forEach(element => {
        element.classList.add('magnetic-element');
        
        element.addEventListener('mousemove', function(e) {
            const rect = this.getBoundingClientRect();
            const x = e.clientX - rect.left - rect.width / 2;
            const y = e.clientY - rect.top - rect.height / 2;
            
            const distance = Math.sqrt(x * x + y * y);
            const maxDistance = 50;
            
            if (distance < maxDistance) {
                const force = (maxDistance - distance) / maxDistance;
                const moveX = x * force * 0.3;
                const moveY = y * force * 0.3;
                
                this.style.transform = `translate(${moveX}px, ${moveY}px) scale(1.05)`;
            }
        });
        
        element.addEventListener('mouseleave', function() {
            this.style.transform = 'translate(0, 0) scale(1)';
        });
    });
}

function initEnhancedParticleSystem() {
    const particlesContainer = document.createElement('div');
    particlesContainer.className = 'enhanced-particles';
    document.body.appendChild(particlesContainer);
    
    function createEnhancedParticle() {
        const particle = document.createElement('div');
        particle.className = 'enhanced-particle';
        
        // Random properties
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDuration = (Math.random() * 5 + 5) + 's';
        particle.style.animationDelay = Math.random() * 2 + 's';
        
        // Random size
        const size = Math.random() * 4 + 2;
        particle.style.width = size + 'px';
        particle.style.height = size + 'px';
        
        particlesContainer.appendChild(particle);
        
        // Remove particle after animation
        setTimeout(() => {
            if (particle.parentNode) {
                particle.parentNode.removeChild(particle);
            }
        }, 10000);
    }
    
    // Create particles periodically
    setInterval(createEnhancedParticle, 300);
    
    // Create initial burst
    for (let i = 0; i < 20; i++) {
        setTimeout(createEnhancedParticle, i * 100);
    }
}

function initMatrixRain() {
    const matrixContainer = document.createElement('div');
    matrixContainer.className = 'matrix-rain';
    document.body.appendChild(matrixContainer);
    
    const characters = '01アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲン';
    
    function createMatrixColumn() {
        const column = document.createElement('div');
        column.className = 'matrix-column';
        
        // Random position
        column.style.left = Math.random() * 100 + '%';
        column.style.animationDuration = (Math.random() * 3 + 2) + 's';
        
        // Random characters
        let text = '';
        for (let i = 0; i < 20; i++) {
            text += characters.charAt(Math.floor(Math.random() * characters.length)) + '<br>';
        }
        column.innerHTML = text;
        
        matrixContainer.appendChild(column);
        
        // Remove column after animation
        setTimeout(() => {
            if (column.parentNode) {
                column.parentNode.removeChild(column);
            }
        }, 5000);
    }
    
    // Create matrix columns periodically
    setInterval(createMatrixColumn, 200);
}

// ===== ENHANCED LOADING ANIMATION =====
function initEnhancedLoader() {
    const loader = document.createElement('div');
    loader.className = 'enhanced-loader';
    loader.innerHTML = `
        <div class="enhanced-loader-content">
            <div class="enhanced-loader-spinner"></div>
            <div class="enhanced-loader-text">Loading Amazing Experience...</div>
            <div class="enhanced-loader-progress">
                <div class="enhanced-loader-progress-bar"></div>
            </div>
        </div>
    `;
    
    document.body.appendChild(loader);
    
    // Simulate loading progress
    setTimeout(() => {
        loader.style.opacity = '0';
        setTimeout(() => {
            if (loader.parentNode) {
                loader.parentNode.removeChild(loader);
            }
        }, 500);
    }, 3000);
}

// ===== ADVANCED INTERACTIONS =====
function initAdvancedInteractions() {
    // Enhanced hover effects
    const hoverElements = document.querySelectorAll('.info-card, .achievement-card, .project-card');
    
    hoverElements.forEach(element => {
        element.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-15px) scale(1.03) rotateX(5deg)';
            this.style.boxShadow = '0 25px 50px rgba(0, 0, 0, 0.4), 0 0 50px rgba(255, 107, 107, 0.3)';
        });
        
        element.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1) rotateX(0deg)';
            this.style.boxShadow = '';
        });
    });
    
    // Enhanced click effects with sound simulation
    const clickElements = document.querySelectorAll('.btn, .nav-link, .social-link');
    
    clickElements.forEach(element => {
        element.addEventListener('click', function(e) {
            // Create enhanced ripple effect
            const ripple = document.createElement('span');
            const rect = this.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height) * 2;
            const x = e.clientX - rect.left - size / 2;
            const y = e.clientY - rect.top - size / 2;
            
            ripple.style.cssText = `
                position: absolute;
                width: ${size}px;
                height: ${size}px;
                left: ${x}px;
                top: ${y}px;
                background: radial-gradient(circle, rgba(255, 255, 255, 0.6) 0%, transparent 70%);
                border-radius: 50%;
                transform: scale(0);
                animation: enhancedRipple 0.8s ease-out;
                pointer-events: none;
                z-index: 1000;
            `;
            
            this.style.position = 'relative';
            this.style.overflow = 'hidden';
            this.appendChild(ripple);
            
            // Add screen shake effect
            document.body.style.animation = 'screenShake 0.3s ease-in-out';
            
            setTimeout(() => {
                ripple.remove();
                document.body.style.animation = '';
            }, 800);
        });
    });
    
    // Parallax effect for background elements
    window.addEventListener('scroll', function() {
        const scrolled = window.pageYOffset;
        const parallaxElements = document.querySelectorAll('.video-background, .enhanced-particles');
        
        parallaxElements.forEach(element => {
            const speed = 0.3;
            element.style.transform = `translateY(${scrolled * speed}px)`;
        });
        
        // Dynamic color change based on scroll
        const scrollPercent = scrolled / (document.documentElement.scrollHeight - window.innerHeight);
        const hue = scrollPercent * 360;
        document.documentElement.style.setProperty('--dynamic-hue', hue);
    });
}

// ===== PERFORMANCE MONITORING =====
function initPerformanceMonitoring() {
    // Monitor FPS
    let fps = 0;
    let lastTime = performance.now();
    
    function calculateFPS() {
        const currentTime = performance.now();
        fps = 1000 / (currentTime - lastTime);
        lastTime = currentTime;
        
        // Adjust animations based on performance
        if (fps < 30) {
            // Reduce particle count
            const particles = document.querySelectorAll('.enhanced-particle');
            particles.forEach((particle, index) => {
                if (index % 2 === 0) {
                    particle.style.display = 'none';
                }
            });
        }
        
        requestAnimationFrame(calculateFPS);
    }
    
    calculateFPS();
}

// ===== ACCESSIBILITY ENHANCEMENTS =====
function initAccessibilityEnhancements() {
    // Add skip links
    const skipLink = document.createElement('a');
    skipLink.href = '#main-content';
    skipLink.textContent = 'Skip to main content';
    skipLink.className = 'sr-only';
    skipLink.style.cssText = `
        position: absolute;
        top: -40px;
        left: 6px;
        background: #000;
        color: #fff;
        padding: 8px;
        text-decoration: none;
        z-index: 10000;
        transition: top 0.3s;
    `;
    
    skipLink.addEventListener('focus', function() {
        this.style.top = '6px';
    });
    
    skipLink.addEventListener('blur', function() {
        this.style.top = '-40px';
    });
    
    document.body.insertBefore(skipLink, document.body.firstChild);
    
    // Add main content landmark
    const mainContent = document.querySelector('.banner');
    if (mainContent) {
        mainContent.id = 'main-content';
        mainContent.setAttribute('role', 'main');
    }
    
    // Enhanced keyboard navigation
    document.addEventListener('keydown', function(e) {
        // Escape key to close modals
        if (e.key === 'Escape') {
            const modal = document.querySelector('.upgrade-modal');
            if (modal) {
                modal.querySelector('.upgrade-modal-close').click();
            }
        }
        
        // Arrow keys for navigation
        if (e.key === 'ArrowDown' && e.ctrlKey) {
            e.preventDefault();
            window.scrollBy(0, 100);
        }
        
        if (e.key === 'ArrowUp' && e.ctrlKey) {
            e.preventDefault();
            window.scrollBy(0, -100);
        }
    });
}

// ===== INITIALIZE ALL ENHANCED FEATURES =====
document.addEventListener('DOMContentLoaded', function() {
    // Initialize enhanced loader first
    initEnhancedLoader();
    
    // Initialize all enhanced features after a delay
    setTimeout(() => {
        initVideoBackground();
        initEnhancedAnimations();
        initAdvancedInteractions();
        initPerformanceMonitoring();
        initAccessibilityEnhancements();
    }, 1000);
});

// Add enhanced CSS animations
const enhancedStyles = document.createElement('style');
enhancedStyles.textContent = `
    @keyframes enhancedRipple {
        to {
            transform: scale(1);
            opacity: 0;
        }
    }
    
    @keyframes screenShake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-2px); }
        75% { transform: translateX(2px); }
    }
    
    @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }
    
    @keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; }
    }
`;
document.head.appendChild(enhancedStyles);

